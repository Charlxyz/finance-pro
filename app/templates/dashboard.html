{% extends 'base.html' %}

{% block title %}Dashboard - FinancePro{% endblock %}

{% block content %}

<div class="max-w-7xl mx-auto px-4 py-10">

    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-10">
        <h1 class="text-3xl font-bold text-gray-800">Dashboard</h1>

        <a onclick="openDepencesModal()"
           class="mt-4 md:mt-0 inline-flex items-center px-5 py-3 bg-red-600 text-white font-semibold rounded-lg shadow hover:bg-red-700 transition">
            + Ajouter une dépense
        </a>
    </div>

    <!-- GRID DES CARTES -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- SOLDE DU COMPTE -->
        <div class="bg-white border border-gray-200 shadow-sm rounded-xl p-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-2">Solde du compte</h2>
            <p class="text-4xl font-bold text-indigo-600">
                <span id="amounnt-bank-main"></span>
            </p>
            <p class="text-sm text-gray-500 mt-2">
                Mise à jour aujourd'hui à 09:42
            </p>
        </div>

        <!-- INVESTISSEMENTS -->
        <div class="bg-white border border-gray-200 shadow-sm rounded-xl p-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-2">Investissements</h2>
            <p class="text-4xl font-bold text-green-600">
                32 800 €
            </p>
            <p class="text-sm text-gray-500 mt-2">
                Portefeuille global (actions, crypto, ETF)
            </p>
        </div>

        <!-- DERNIÈRES ENTRÉES -->
        <div class="bg-white border border-gray-200 shadow-sm rounded-xl p-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-2">Dernières entrées</h2>

            <ul id="last-3-enter" class="space-y-3 mt-3"></ul>    

        </div>

        <!-- DERNIÈRES SORTIES -->
        <div class="bg-white border border-gray-200 shadow-sm rounded-xl p-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-2">Dernières sorties</h2>
                
            <!-- Ajout par le JS -->
            <ul id="last-3-depence" class="space-y-3 mt-3"></ul>    
        </div>
    </div>
</div>

<!-- MODAL DEPENCES -->
<div id="depences-modal" 
     class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4">

    <div class="bg-white w-full max-w-md rounded-xl shadow-lg p-6 relative 
                max-h-[90vh] overflow-y-auto">

        <!-- Bouton fermer -->
        <button onclick="closeDepencesModal()" 
                class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-2xl">
            &times;
        </button>

        <h2 class="text-xl font-bold text-gray-800 mb-4">
            Ajouter une dépense
        </h2>

        <div class="space-y-5">

            <!-- MONTANT -->
            <div>
                <label class="block text-gray-700 font-semibold mb-1">Montant</label>
                <input type="number" step="0.01" name="amount" id="depence-amount" required
                       placeholder="Ex : 42.50"
                       class="w-full px-4 py-2.5 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-600">
            </div>

            <!-- CATÉGORIE -->
            <div>
                <label class="block text-gray-700 font-semibold mb-1">Catégorie</label>
                <select name="category" id="depence-category" required
                        class="w-full px-4 py-2.5 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-red-500">
                    <option value="">Choisir une catégorie</option>
                    <option value="Logement">Logement</option>
                    <option value="Transport">Transport</option>
                    <option value="Courses">Courses</option>
                    <option value="Santé">Santé</option>
                    <option value="Loisirs">Loisirs</option>
                    <option value="Abonnement">Abonnement</option>
                    <option value="Autre">Autre</option>
                </select>
            </div>

            <!-- DATE -->
            <div>
                <label class="block text-gray-700 font-semibold mb-1">Date</label>
                <input type="date" name="date" id="depence-date" required
                       class="w-full px-4 py-2.5 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-red-500" />
            </div>

            <!-- COMPTE -->
            <div>
                <label class="block text-gray-700 font-semibold mb-1">Compte associé</label>
                <select name="account_id" id="depence-compte" required
                        class="w-full px-4 py-2.5 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500">
                    <option value="">Sélectionner un compte</option>
                </select>
            </div>

            <!-- DESCRIPTION -->
            <div>
                <label class="block text-gray-700 font-semibold mb-1">Description (optionnel)</label>
                <textarea name="description" rows="3" id="depence-description"
                          placeholder="Ex : courses alimentaires, facture EDF..."
                          class="w-full px-4 py-2.5 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500"></textarea>
            </div>

            <hr>

            <!-- BOUTONS -->
            <button onclick=""
                    class="w-full py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition">
                Ajouter la dépense
            </button>

            <button onclick="closeDepencesModal()"
                    class="w-full py-3 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition">
                Annuler
            </button>

        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

{% endblock %}
